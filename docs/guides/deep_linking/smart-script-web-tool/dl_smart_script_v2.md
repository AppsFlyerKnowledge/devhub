---
title: "OneLink Smart Script V2"
slug: "dl_smart_script_v2"
category: 6384c30e5a754e005f668a74
parentDoc: 63ad67e32f0483001e26406b
hidden: false
createdAt: "2022-12-29T10:12:10.569Z"
updatedAt: "2023-05-07T20:29:27.336Z"
---
**At a glance**: Customize OneLinks that are automatically generated and embedded behind a button or banner on your brand's website.


[block:tutorial-tile]
{
  "backgroundColor": "#018FF4",
  "emoji": "ðŸ¦‰",
  "id": "62bd963f6f466b00926ab69f",
  "link": "https://dev.appsflyer.com/v0.1/recipes/smart-script-quick-start-single-key",
  "slug": "smart-script-quick-start-single-key",
  "title": "Smart Script Quick Start - Single Key"
}
[/block]



[block:embed]
{
  "html": "<iframe class=\"embedly-embed\" src=\"//cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Ffast.wistia.net%2Fembed%2Fiframe%2F9sx58ic0e3&display_name=Wistia%2C+Inc.&url=https%3A%2F%2Fappsflyer.wistia.com%2Fmedias%2F9sx58ic0e3&image=https%3A%2F%2Fembed-ssl.wistia.com%2Fdeliveries%2F36d0dbecf1b69f6898d748446b91153fb897c467.jpg%3Fimage_crop_resized%3D640x360&key=f2aa6fc3595946d0afc3d76cbbd25dc3&type=text%2Fhtml&schema=wistia\" width=\"640\" height=\"360\" scrolling=\"no\" title=\"Wistia, Inc. embed\" frameborder=\"0\" allow=\"autoplay; fullscreen\" allowfullscreen=\"true\"></iframe>",
  "url": "https://appsflyer.wistia.com/medias/9sx58ic0e3",
  "title": "smart_script_v2",
  "favicon": "https://appsflyer.wistia.com/favicon.ico",
  "image": "https://embed-ssl.wistia.com/deliveries/36d0dbecf1b69f6898d748446b91153fb897c467.jpg?image_crop_resized=640x360",
  "provider": "appsflyer.wistia.com",
  "href": "https://appsflyer.wistia.com/medias/9sx58ic0e3"
}
[/block]


## About OneLink Smart Script

OneLink Smart Script uses incoming URLs leading to the webpage to automatically generate unique outgoing OneLink URLs leading to the app store.

The outgoing URLs are generated using [arguments](https://dev.appsflyer.com/hc/docs/onelink-smart-script-v2web-to-app-url-generator#arguments) you receive from the marketer and input into the script. **Note**: The `afParameters` argument has a structure made up of several other arguments (parameters), each of which contains a [configuration object](https://dev.appsflyer.com/hc/docs/onelink-smart-script-v2web-to-app-url-generator#configuration-object) that has keys, override values, and a default value.

## Implementation steps

To set up the Smart Script, you can either:

### Embed the script in your website

The Smart Script initialization and calling code can be either come from the Smart Script generator in the AppsFlyer dashboard (**recommended**), or imported and called manually by the developer.

> ðŸ“˜ Preserve incoming URL parameters
> 
> In order to ensure incoming URL parameters will be mapped to the generated OneLink, it is recommended to import the Smart Script in every website page, whether a OneLink is generated in the page or not.
> 
> Available from version 2.5.0.
> 
> More details and a full example [here](https://dev.appsflyer.com/hc/docs/dl_smart_script_v2#preserve-incoming-url-parameters-across-pages).

#### Use code generated by the Smart Script generator

1. Get the file from the marketer that includes the script, initialization code, and arguments.
2. Test the script on the [Smart Script test page](https://appsflyersdk.github.io/appsflyer-onelink-smart-script/examples/test_page.html). Ensure the correct outgoing URL is generated.
3. Follow the [test and use Smart Script result instructions](https://dev.appsflyer.com/hc/docs/onelink-smart-script-v2web-to-app-url-generator#check-and-use-smart-script-result).

[See integration example in Github](https://github.com/AppsFlyerSDK/appsflyer-onelink-smart-script/blob/main/examples/generator_integration.html)

#### Manually configure the script

1. [Download the script](https://onelinksmartscript.appsflyer.com/onelink-smart-script-latest.js).
2. Get the arguments to call the script which map the incoming parameters to the outgoing parameters from the marketer.
3. Initialize the Smart Script [arguments](https://dev.appsflyer.com/hc/docs/onelink-smart-script-v2web-to-app-url-generator#arguments) and [configuration objects](https://dev.appsflyer.com/hc/docs/onelink-smart-script-v2web-to-app-url-generator#configuration-object).
4. Generate the URLs by calling the script in the web/landing page HTML using the following method:

```javascript
var result = window.AF_SMART_SCRIPT.generateOneLinkURL({
  oneLinkURL,
  afParameters,
  referrerSkipList, // optional
  urlSkipList // optional
})
```

5. Follow the [test and use Smart Script result instructions](https://dev.appsflyer.com/hc/docs/onelink-smart-script-v2web-to-app-url-generator#check-and-use-smart-script-result).

#### Check and use Smart Script result

1. Check the return value in `result`. Possible return values are:  
   - An outgoing Onelink URL. Use the result value as needed. For example, to place it as a link under a CTA on your website.
   - `null`. If the script returns `null`, implement your desired error flow. For example: the web/landing page's existing URL is not changed.

```javascript
      var result_url = "No output from script"
      if (result) {
            result_url = result.clickURL;            
            // Put the generated OneLink URL behind CTA buttons
            document.getElementById('andrd_link').setAttribute('href', result_url);
            document.getElementById('ios_link').setAttribute('href', result_url);
            // Optionally - Create QR code from the generated OneLink URL
            window.AF_SMART_SCRIPT.displayQrCode("my_qr_code_div_id");
            //The size of the QR code is defined in the CSS file under #my_qr_code_div_id
            // #my_qr_code_div_id canvas { 
            //  height: 200px;
            //  width: 200px;
            //}
            // Optionally - fire an impression.
            // The impression will fire to https://impressions.onelink.me//.... 
            setTimeout(() => {
              window.AF_SMART_SCRIPT.fireImpressionsLink();
              console.log("Impression fired"); 
            }, 1000);
      }
```

### Use Google Tag Manager

To set up the Smart Script in Google Tag Manager:

1. Confirm that the marketer followed their [instructions](https://support.appsflyer.com/hc/en-us/articles/4413588932241#set-up-onelink-smart-script) and placed the Smart Script code into GTM.
2. Check the return value in `AF_SMART_SCRIPT_RESULT`. Possible return values are:  
   - An outgoing OneLink URL. Use the result value as needed. For example, to place it as a link under a CTA on your website.
   - `null`. If the script returns `null`, implement your desired error flow. For example: the web/landing page's existing URL is not changed.

```javascript
      var result_url = AF_SMART_SCRIPT_RESULT.clickURL;
      if (result_url) {
            document.getElementById('andrd_link').setAttribute('href', result_url);
            document.getElementById('ios_link').setAttribute('href', result_url);
            // Optionally - Create QR code from the generated OneLink URL
            window.AF_SMART_SCRIPT.displayQrCode("my_qr_code_div_id");
            //The size of the QR code is defined in the CSS file under #my_qr_code_div_id
            // #my_qr_code_div_id canvas { 
            //  height: 200px;
            //  width: 200px;
            //}
            // Optionally - fire an impression.
            // The impression will fire to https://impressions.onelink.me//.... 
            setTimeout(() => {
              window.AF_SMART_SCRIPT.fireImpressionsLink();
              console.log("Impression fired"); 
            }, 1000);            
      }
```

3. Test the script on the [Smart Script test page](https://appsflyersdk.github.io/appsflyer-onelink-smart-script/examples/test_page.html). Ensure the correct outgoing URL is generated.

### Create a QR code with the Smart Script result

**Prerequisite**: Smart Script V2.6+

> ðŸ“˜ Best practices
> 
> - Customize the QR code according to your app brand with a center logo and a relevant code color
> - Show the QR code when users are on desktop and show the button with the link when users are on mobile

**To create a QR code**:

1. Create a div tag with a specific ID in your site's HTML page to host the QR code.  
   You can style the div tag however you want.
2. After you run the Smart Script and generate a OneLink URL, call the following method `displayQrCode`

#### `displayQrCode`

***

**Method signature**

```javascript
const qrOptions = {
  logo,
  colorCode
}

window.AF_SMART_SCRIPT.displayQrCode(divId, qrOptions)
```

**Input arguments**

| Type     | Mandatory | Name        | Description                                                                 | Comment                                                                               |
| :------- | :-------- | :---------- | :-------------------------------------------------------------------------- | :------------------------------------------------------------------------------------ |
| `String` | Yes       | `divID`     | A `div` tag with a specific ID in your site's HTML page to host the QR code |                                                                                       |
| `Object` | No        | `qrOptions` | Configuration object (see details in the table below)                       | If the object is missing, the QR code will be created without a logo in default color |

**`qrOptions` object**

| Type     | Mandatory | Name        | Description                            | Comment                                                                          |
| :------- | :-------- | :---------- | :------------------------------------- | :------------------------------------------------------------------------------- |
| `String` | No        | `logo`      | A valid image URL or an image data-URI | If the value is invalid, the QR code will be generated without the logo          |
| `String` | No        | `colorCode` | Hex color of the QR code               | If the value is invalid, the code color will fallback to the default black color |

**Usage examples:**

- _QR code without logo and without custom color_ [Github example](https://appsflyersdk.github.io/appsflyer-onelink-smart-script/examples/qr_code.html?incmp=gogo&inmedia=email)
- _QR code with logo and custom code color_ [Github example](https://appsflyersdk.github.io/appsflyer-onelink-smart-script/examples/qr_code_logo_color.html?incmp=gogo&inmedia=email)

### Fire an impression

You can fire an impression when a page loads, a CTA or banner displays, etc. **Note**: Impressions can only be fired on mobile devices; not on desktop.

**Prerequisite**: Smart Script V2.2+

**To fire an impression**:

1. Follow the instructions to run the Smart Script and generate a click URL.
2. Make sure the result is valid (and not null).
3. Run the following impression function:

> ðŸš§ A must-do workaround
> 
> Please wrap the call to `fireImpressionsLink` with `setTimeout` to make sure there is at least 1 second of delay between the call to `generateOneLinkURL` and `fireImpressionsLink`

```javascript
setTimeout(() => {
  window.AF_SMART_SCRIPT.fireImpressionsLink();
  console.log("Impression fired"); 
}, 1000);
```
You can find examples for firing impressions for [mobile only](#impressions---onelink-template-with-mobile-only-support) and for [cross platform support](#impressions---onelink-template-with-cross-platform-support)

## Arguments

[block:html]
{
  "html": "<table class=\"table--hover table--striped table--color-header unsortable\" style=\"height: 532px; width: 842px;\">\n  <thead>\n    <tr style=\"height: 40px;\">\n      <th style=\"width: 272.312px;\" colspan=\"2\">Argument</th>\n      <th style=\"width: 291.5px; height: 40px;\">Remarks</th>\n      <th style=\"width: 268.188px; height: 40px;\">Example</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr style=\"height: 19px;\">\n      <td style=\"width: 264.312px;\" colspan=\"2\">oneLinkURL (required)</td>\n      <td style=\"width: 283.5px; height: 19px;\">\n        <ul>\n          <li>\n            Provide the OneLink template domain + template ID.\n            <strong>Note: </strong>Not a OneLink custom link URL!\n          </li>\n        </ul>\n      </td>\n      <td style=\"width: 260.188px; height: 19px;\">\n        <ul>\n          <li>\n            <strong>yourbrand.onelink.me/A1b2</strong>\n          </li>\n          <li>\n            Branded domain example: <strong>click.yourbrand.com/A1b2</strong>\n          </li>\n        </ul>\n      </td>\n    </tr>\n    <tr style=\"height: 19px;\">\n      <td style=\"width: 119.953px;\" rowspan=\"9\">\n        <p>afParameters</p>\n        <p>(required)</p>\n        <p>&nbsp;</p>\n        <p>&nbsp;</p>\n        <p>&nbsp;</p>\n        <span style=\"font-weight: 400;\"><br></span>\n      </td>\n      <td style=\"width: 133.359px; height: 19px;\">\n        <p>mediaSource</p>\n        <p>(required)</p>\n      </td>\n      <td style=\"width: 283.5px; height: 19px;\">\n        <p>Configuration object for media source</p>\n      </td>\n      <td style=\"width: 260.188px; height: 19px;\">\n        <ul>\n          <li>Keys: ['incoming_mediasourceâ€™' 'utm_source']</li>\n          <li>\n            Override values: {twitter: 'twitter_int', orig_src: 'new_src'}\n          </li>\n          <li>Default value: ['any_source']</li>\n        </ul>\n      </td>\n    </tr>\n    <tr style=\"height: 40px;\">\n      <td style=\"width: 133.359px; height: 40px;\">\n        <p>campaign</p>\n      </td>\n      <td style=\"width: 283.5px; height: 40px;\">\n        <p>Configuration object for campaign</p>\n      </td>\n      <td style=\"width: 260.188px; height: 40px;\">\n        <ul>\n          <li>Keys: ['incoming_campaign', 'utm_campaign']</li>\n          <li>Override values: {campaign_name: 'new_campaign_name'}</li>\n          <li>Default value: ['any_campaign_name']</li>\n        </ul>\n      </td>\n    </tr>\n    <tr>\n      <td style=\"width: 133.359px;\">\n        <p>channel</p>\n      </td>\n      <td style=\"width: 283.5px;\">\n        <p>Configuration object for channel</p>\n      </td>\n      <td style=\"width: 260.188px;\">\n        <ul>\n          <li>Keys: ['incoming_channel', 'utm_channel']</li>\n          <li>Override values: {video: 'new_video'}</li>\n          <li>Default value: ['any_video']</li>\n        </ul>\n      </td>\n    </tr>\n    <tr style=\"height: 83px;\">\n      <td style=\"width: 133.359px; height: 83px;\">\n        <p>ad</p>\n      </td>\n      <td style=\"width: 283.5px; height: 83px;\">\n        <p>Configuration object for ad</p>\n      </td>\n      <td style=\"width: 260.188px; height: 83px;\">\n        <ul>\n          <li>Keys: ['incoming_ad', 'utm_ad']</li>\n          <li>Override values: {ad_name: 'new_ad_name'}</li>\n          <li>Default value: ['any_ad_name']</li>\n        </ul>\n      </td>\n    </tr>\n    <tr style=\"height: 62px;\">\n      <td style=\"width: 133.359px; height: 62px;\">adSet</td>\n      <td style=\"width: 283.5px; height: 62px;\">\n        <p>Configuration object for adset</p>\n      </td>\n      <td style=\"width: 260.188px; height: 62px;\">\n        <ul>\n          <li>Keys: ['incoming_adset', 'utm_adset']</li>\n          <li>Override values: {'adset_name': 'new_adset_name'}</li>\n          <li>Default value: ['any_adset_name']</li>\n        </ul>\n      </td>\n    </tr>\n    <tr style=\"height: 83px;\">\n      <td style=\"width: 133.359px; height: 83px;\">deepLinkValue</td>\n      <td style=\"width: 283.5px; height: 83px;\">\n        <p>\n          Configuration object for <code>deep_link_value</code>\n        </p>\n      </td>\n      <td style=\"width: 260.188px; height: 83px;\">\n        <ul>\n          <li>Keys: ['product_id', 'page_name']</li>\n          <li>Override values: {twenty_percent_off: 'thirty_percent_off'}</li>\n          <li>Default value: 'new_offers_page'</li>\n        </ul>\n      </td>\n    </tr>\n    <tr>\n      <td style=\"width: 133.359px;\">afSub1-5</td>\n      <td style=\"width: 283.5px;\">\n        <p>\n          Configuration object for <code>af_sub[1-5]</code>\n        </p>\n      </td>\n      <td>&nbsp;</td>\n    </tr>\n    <tr style=\"height: 40px;\">\n      <td style=\"width: 133.359px; height: 39px;\">googleClickIdKey</td>\n      <td style=\"width: 283.5px; height: 39px;\">\n        <p>\n          State what to call the parameter that carries the\n          <a href=\"https://support.google.com/google-ads/answer/9744275?hl=en\" target=\"_blank\" rel=\"noopener\">GCLID</a>.<br>\n          <strong>Note</strong>!\n          <span style=\"font-weight: 400;\">To display in AppsFlyer raw data reports, the param must be one of <strong>af_sub[1-5]</strong>.</span>\n        </p>\n      </td>\n      <td style=\"width: 260.188px; height: 39px;\">&nbsp;</td>\n    </tr>\n    <tr style=\"height: 83px;\">\n      <td style=\"width: 133.359px; height: 83px;\">\n        <span style=\"font-weight: 400;\">Other (custom) query parameters</span><span style=\"font-weight: 400;\"><br></span>\n      </td>\n      <td style=\"width: 283.5px; height: 83px;\">\n        <ul>\n          <li>\n            List of any other parameters you want to be included in the\n            outgoing OneLink URL for attribution or deep linking, along\n            with their configuration objects.\n          </li>\n          <li>\n            The name of the custom parameter is listed by the developer\n            as <code>paramKey</code> in the configuration object.\n          </li>\n        </ul>\n      </td>\n      <td style=\"width: 260.188px; height: 83px;\">\n        <ul>\n          <li>paramKey: 'deep_link_sub1'</li>\n          <li>Keys: ['page_id']</li>\n          <li>Override values: {page12: 'new_page12'}</li>\n          <li>Default value: 'page1'</li>\n        </ul>\n      </td>\n    </tr>\n    <tr>\n      <td colspan=\"2\">\n        <span style=\"font-weight: 400;\">&nbsp;</span><br>\n        <span style=\"font-weight: 400;\">referrerSkipList</span>\n      </td>\n      <td style=\"width: 283.5px;\">\n        List of the strings in the HTTP referrer for a particular click (for\n        example Twitter or Meta ads) that if found, cause the Smart Script\n        to return <code>null</code>. This can be useful for SRNs like Twitter\n        and Meta ads, for which clicks are already reported.\n      </td>\n      <td style=\"width: 260.188px;\">&nbsp;</td>\n    </tr>\n    <tr>\n      <td style=\"width: 119.953px;\" colspan=\"2\">\n        <span style=\"font-weight: 400;\">urlSkipList</span>\n      </td>\n      <td style=\"width: 283.5px;\">\n        <span>List of the strings in the URL for a particular click (for example <code>af_r</code>) that if found, cause the Smart Script to return&nbsp;</span><code><span>null</span></code><span>. This can be useful if you use an AppsFlyer attribution link with af_r to redirect users to your mobile website, and don't want data from the original click to be lost.</span>\n      </td>\n      <td style=\"width: 260.188px;\">&nbsp;</td>\n    </tr>\n    <tr>\n      <td style=\"width: 119.953px;\" colspan=\"2\">\n        <span style=\"font-weight: 400;\">webReferrer</span>\n      </td>\n      <td style=\"width: 283.5px;\">\n        <span>This argument defines a key in the outgoing URL, which its value will be a copy of the HTTP <code>document.referrer</code>. The referrer is saved in the first page the user lands in, and may be used in any consecutive page in this domain which runs Smart Script with this argument.</span>\n      </td>\n      <td style=\"width: 260.188px;\">&nbsp;</td>\n    </tr>\n  </tbody>\n</table>"
}
[/block]

## Configuration object

The OneLink Smart Script uses arguments to generate an outgoing URL based on the parameters of the incoming URL and the arguments defined in the script. The afParameters argument has a structure made up of several other arguments (parameters) used for attribution and deep linking, each of which contains a configuration object that has keys, override values, and a default value, as described in the table that follows.

[block:html]
{
  "html": " <table class=\"table--hover table--striped table--color-header unsortable\" style=\"height: 301px;\">\n        <thead>\n          <tr style=\"height: 40px;\">\n            <th style=\"width: 147.969px; height: 40px;\">Argument</th>\n            <th style=\"width: 283.359px; height: 40px;\">Description</th>\n            <th style=\"width: 200.172px; height: 40px;\">Example</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr style=\"height: 223px;\">\n            <td style=\"width: 139.969px; height: 223px;\">keys</td>\n            <td style=\"width: 275.359px; height: 223px;\">\n              <ul>\n                <li>List of strings</li>\n                <li>\n                  <span>List of possible parameter/s in the incoming URL the script looks for, the value of which is placed as the value in the outgoing URL.</span>\n                </li>\n                <li>\n                  The script searches from left to right and stops\n                  at the first match.\n                </li>\n              </ul>\n            </td>\n            <td style=\"width: 192.172px; height: 223px;\">\n              <ul>\n                <li>Example: ['in_channel', 'utm_channel']</li>\n                <li>\n                  For the channel parameter in the script, the\n                  script searches the incoming link for in_channel\n                  and uses the value as the value for channel.\n                </li>\n              </ul>\n            </td>\n          </tr>\n          <tr style=\"height: 19px;\">\n            <td style=\"width: 139.969px; height: 19px;\">\n              <p>overrideValues</p>\n            </td>\n            <td style=\"width: 275.359px; height: 19px;\">\n              <ul>\n                <li>Dictionary {string: string}</li>\n                <li>\n                  <span>For values you want changed in the outgoing link, list the values in the incoming URL, alongside what you want them to be replaced with.</span>\n                </li>\n                <li>\n                  The script replaces the param values of the incoming\n                  URL with the values you define.&nbsp;\n                </li>\n              </ul>\n            </td>\n            <td style=\"width: 192.172px; height: 19px;\">\n              <p>Example: {'video': 'video_new'}</p>\n              <p>\n                For the channel parameter in the script, anytime\n                the incoming value is video, the script changes it\n                to video_new on the outgoing link.\n              </p>\n            </td>\n          </tr>\n          <tr style=\"height: 19px;\">\n            <td style=\"width: 139.969px; height: 19px;\">defaultValue</td>\n            <td style=\"width: 275.359px; height: 19px;\">\n              <ul>\n                <li>String</li>\n                <li>\n                  <span>State what you want your \"fallback\" value to be.</span>\n                </li>\n                <li>\n                  <span>If a parameter is not found from your key list, the defaultValue value is used in the outgoing URL.</span>\n                </li>\n                <li>\n                  <span>You can force a default value by passing an empty keys list.</span>\n                </li>\n              </ul>\n            </td>\n            <td style=\"width: 192.172px; height: 19px;\">\n              <p>Example: ['web_video']</p>\n              <p>\n                For the channel parameter in the script, if you have\n                the param in_channel is not found, web_video is used\n                as the channel value.\n              </p>\n            </td>\n          </tr>\n        </tbody>\n      </table>"
}
[/block]

## Examples

### Basic attribution

See [example](https://appsflyersdk.github.io/appsflyer-onelink-smart-script/examples/single_key.html?incmp=gogo&inmedia=email) of the basic conversion of an incoming URL to an outgoing OneLink URL, with a single key for media_source and campaign

### Multiple keys

See [example](https://appsflyersdk.github.io/appsflyer-onelink-smart-script/examples/multiple_keys.html?incmp11=gogo11&inmedia22=email22) of the conversion of an incoming URL to an outgoing OneLink URL, with multiple keys for media_source and campaign.

### UTM parameters

See [example](https://appsflyersdk.github.io/appsflyer-onelink-smart-script/examples/utm_parameters.html?utm_campaign=mycmpn&utm_source=mysource) of the conversion of an incoming URL to an outgoing OneLink URL, with UTM parameters for media_source and campaign.

### Override values

See [example](https://appsflyersdk.github.io/appsflyer-onelink-smart-script/examples/override_mediasource.html?inmedia=old_value) of the conversion of an incoming URL to an outgoing OneLink URL, replacing the incoming media_source value.

### Default values

See [example](https://appsflyersdk.github.io/appsflyer-onelink-smart-script/examples/override_mediasource.html?inmedia_found=orig_media_value) of the conversion of an incoming URL to an outgoing OneLink URL, using the default value when an incoming media_source value isn't found.

### Forced default values

See [example](https://appsflyersdk.github.io/appsflyer-onelink-smart-script/examples/forced_default_values.html?inmedia_found=plain_media_source) of the conversion of an incoming URL to an outgoing OneLink URL, using the default value even when an incoming media_source value is found.

### Google click ID passthrough

See [example](https://appsflyersdk.github.io/appsflyer-onelink-smart-script/examples/google_clickid.html?inmedia=email&gclid=1a2b3c&keyword=sale%2Bboat) of the conversion of an incoming URL to an outgoing OneLink URL that passes the Google click ID to `af_sub4` and `gclid`.
**Note**: When a GCLID is found, the script looks for the incoming parameter keyword, and puts the keyword value in the outgoing URL as the value of af_keywords.

### Facebook click ID passthrough

See [example](https://appsflyersdk.github.io/appsflyer-onelink-smart-script/examples/facebook_clickid.html?inmedia=email&fbclid=7hjy89) of the conversion of an incoming URL to an outgoing OneLink URL that passes the Facebook click ID to `af_sub2` and `fbclid`.

### Set attribution and OneLink parameters

See [example](https://appsflyersdk.github.io/appsflyer-onelink-smart-script/examples/onelink_parameters.html?inmedia=email&dp_dest=apples&inchnl=this_channel&promo=buy99) of the conversion of an incoming URL to an outgoing OneLink URL with AppsFlyer attribution and OneLink parameters. 

### Set additional custom parameters

See [example](https://appsflyersdk.github.io/appsflyer-onelink-smart-script/examples/onelink_custom_parameters.html?inmedia=email&dp_dest=apples&pageid=2g4f&productid=shirt12&partner=bigagency) of the conversion of an incoming URL to an outgoing OneLink URL with additional custom parameters (including the af_prt parameter for agencies). 

### Referrer skip list

See [example](https://appsflyersdk.github.io/appsflyer-onelink-smart-script/examples/referrer_skip_list.html?incmp=gogo&inmedia=email) of how you can disable the Smart Script for a particular click (for example, from Twitter or Meta ads) by creating a skip list. If any of the strings in the skip list appear in the HTTP referrer of the click, the Smart Script returns `null`.

### URL skip list

See [example](https://appsflyersdk.github.io/appsflyer-onelink-smart-script/examples/url_skip_list.html?incmp=gogo&inmedia=email&af_r=hotel.me) of how you can disable the Smart Script for a particular string in the URL (for example, `af_r`) by creating a skip list. If any of the strings in the skip list appear in the URL of the click, the Smart Script returnsÂ `null`.

### Smart Script set up with Google Tag Manager

See [example](https://appsflyersdk.github.io/appsflyer-onelink-smart-script/examples/google_tag_manager.html?my_source=email&app_dest=planes&typeid=b787&msg_id=f7h8) of the conversion of an incoming URL to an outgoing OneLink URL using OneLink Smart Script set up using Google Tag Manager. 

### Impressions - OneLink Template with mobile-only support

See [example](https://appsflyersdk.github.io/appsflyer-onelink-smart-script/examples/impressions_mobile.html?incmp=gogo&inmedia=email) of an impressions fired using a OneLink template who has only mobile device.

> ðŸš§ A must-do workaround
> 
> Please wrap the call to `fireImpressionsLink` with `setTimeout` to make sure there is at least 1 second of delay between the call to `generateOneLinkURL` and `fireImpressionsLink`

### Impressions -  OneLink Template with Cross-platform support

See [example](https://appsflyersdk.github.io/appsflyer-onelink-smart-script/examples/impressions_cross_platform.html?incmp=gogo&inmedia=email) of an impressions fired using a OneLink template who has cross-platform support.  
For example an impression fired from a non-mobile platform (e.g desktop or console).

> ðŸ“˜ Firing an impression from a cross platform landing page
> 
> You can find here a [code example](https://github.com/AppsFlyerSDK/appsflyer-sample-app-smartscript-demo-page/blob/8c0b6e7385b3b0cedd1208a530f002438a336e76/index.html#L241-L244) for firing an impression from a [demo landing page](https://appsflyersdk.github.io/appsflyer-sample-app-smartscript-demo-page/)  

> ðŸš§ A must-do workaround
> 
> Please wrap the call to `fireImpressionsLink` with `setTimeout` to make sure there is at least 1 second of delay between the call to `generateOneLinkURL` and `fireImpressionsLink`

### Preserve incoming URL parameters across pages

> ðŸ“˜ 
> 
> Available from version 2.5.0.

Incoming parameters (e.g. `utm_source`) from a landing page are not passed to other pages in the website by default.  
Importing Smart Script in every website page preserves the incoming URL parameters, and allows Smart Script to use them in other pages.

You can find here [an example](https://appsflyersdk.github.io/appsflyer-onelink-smart-script/examples/save_params_demo/save_params_demo_home.html?utm_source=my_source&utm_channel=my_channel) of this use case.

### Copy HTTP referrer to outgoing URL

> ðŸ“˜ 
> 
> Available from version 2.7.0.

You can set Smart Script to copy the HTTPÂ `document.referrer`Â to either a custom outgoing URL parameter or predefined outgoing URL parameters. If you want to see web referrer values in dashboards or in raw data reports, we suggest using one of the followingÂ **predefined**Â outgoing URL parameters:

- `af_channel`Â - Parameter is available in dashboards and raw data
- `af_sub1-5` - The parameter is available in raw data under theÂ **af_sub1-5**Â columns and in theÂ **original URL**Â column.

If you want to set a custom parameter, Smart Script has to copy the  Â `document.referrer`Â property value and set it as the value of the parameter. In this [example](https://appsflyersdk.github.io/appsflyer-onelink-smart-script/examples/webreferrer.html?utm_source=my_source&utm_channel=my_channel),  Smart Script copies theÂ `document.referrer`Â value to a custom outgoing URL parameter key defined byÂ `webReferrer`. The selected custom key in the example isÂ `this_referrer`.

For more information, seeÂ [Web referrer mapping](https://support.appsflyer.com/hc/en-us/articles/4413588932241-OneLink-Smart-Script-V2-setup#web-referrer-mapping).

### Utilizing Local Storage to Set Parameters for Deep Linking

You can choose to save any data from the website to local storage, and then configure Smart Script to retrieve this data and assign it to an outgoing URL parameter. For example, you can leverage website information to dynamically populate the `deep_link_value` parameter, enabling the deep linking of users directly to the app's relevant content.

In [this example](https://appsflyersdk.github.io/appsflyer-onelink-smart-script/examples/key_from_local_storage.html?incmp11=gogo11&inmedia22=email22), you can see how the outgoing URL `deep_link_value` is populated by a value copied from the website's local storage. The copied value in this example is the product ID arriving from the website data.
